<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>에너지 데이터 대시보드</title>
    <link rel="stylesheet" href="style.css">
    <!-- Chart.js 4.x -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Chart.js Annotation Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <!-- PapaParse 5.x -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
    <!-- 로딩 스피너 -->
    <div id="loading" class="loading-overlay">
        <div class="spinner"></div>
        <p>데이터 처리 중...</p>
    </div>

    <!-- 메인 컨테이너 -->
    <div class="container">
        <header>
            <h1>에너지 데이터 분석</h1>
            <p>ESS 도입 전후 부하 비교 및 배터리 운영 현황</p>
        </header>

        <!-- CSV 업로드 섹션 -->
        <div id="upload-section" class="card upload-section">
            <div class="upload-box">
                <div class="upload-icon-wrapper">
                    <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                </div>
                <h2>데이터 파일 업로드</h2>
                <p>timestamp, load_kW, G_kW, P_c_kW, P_d_kW 열이 포함된 CSV 파일</p>
                <input type="file" id="csv-upload" accept=".csv" />
                <label for="csv-upload" class="upload-btn">파일 선택</label>
                <p id="file-name" class="file-name"></p>
            </div>
        </div>

        <!-- 대시보드 섹션 (초기에는 숨김) -->
        <div id="dashboard-section" class="dashboard-section" style="display: none;">
            <!-- 날짜 선택 -->
            <div class="card control-panel">
                <div class="date-selector-wrapper">
                    <label for="date-picker">날짜 선택</label>
                    <select id="date-picker"></select>
                </div>
            </div>

            <!-- 차트 영역 -->
            <div class="charts-container">
                <!-- ESS 도입 전후 비교 차트 -->
                <div class="card chart-card">
                    <div class="chart-header">
                        <h3>ESS 도입 전후 부하 비교</h3>
                        <span class="chart-subtitle">시간대별 부하 변화 추이 (피크값 표시)</span>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="load-comparison-chart"></canvas>
                    </div>
                </div>

                <!-- 배터리 상태 차트 -->
                <div class="card chart-card">
                    <div class="chart-header">
                        <h3>배터리 운영 현황</h3>
                        <span class="chart-subtitle">시간대별 충전/방전/대기 상태</span>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="battery-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 리셋 버튼 -->
            <div class="reset-section">
                <button id="reset-btn" class="reset-btn">
                    <span>새 파일 업로드</span>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
                        <path d="M21 3v5h-5"></path>
                        <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
                        <path d="M3 21v-5h5"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script src="/power-dashboard/script.js"></script>

</body>

</html>
